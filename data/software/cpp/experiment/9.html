<div title="C实验报告[9]" class="article-content">
<div class="sign">2007-02-06 11:31</div>
<p>实验内容及要求：</p>
<ol>
  <li>编写程序完成一个简单职工信息系统设计。</li>
  <li>请同学完成以下程序的编写。</li>
</ol>
<p>一、编写一个建立一个输入职工信息（职工号，姓名，年龄，工资）的函数，并把职工信息存入文件“work.txt”中；写一个按照职工号查一个职工工资的函数；再写一个修改函数，实现工资小于800元的职工加90元，并把修改工资的职工信息建成一个文件“workmodify.txt”；最后写一个主函数先调用建立函数，再调用查询函数对查到的职工信息进行显示，最后调用修改函数修改职工工资。</p>
<p>二、要求职工信息存储在文件或结构体数组（自己选择），编写程序实现上述功能。</p>
<p>要求：请同学把预备知识、步骤、程序框图、调试好的程序及存在的问题写在下面（不够可以附页）。</p>
<pre><code data-language="c">#include&lt;stdio.h&gt;
#include&lt;string.h&gt;

int search_work(char *filename,int num)
{
  int numb;
  int income;
  FILE *fp;

  if((fp=fopen(filename,"r"))==NULL)
  {
    printf("Can't open %s \n",filename);
    return 1;
  }
  while(fscanf(fp,"%d %*s %*d %d",&amp;numb,&amp;income),numb!=num &amp;&amp; !feof(fp));
  if(numb==num)
    printf("%d %d\n",numb,income);
  fclose(fp);
  return 0;
}

int add(char *filename,char *fileout,int n)
{
  FILE *fp,*fpt;
  int num,age,income;
  char name[80];

  fp=fopen(filename,"r");
  fpt=fopen(fileout,"w+");
  while(n--)
  {
    fscanf(fp,"%d %s %d %d",&amp;num,name,&amp;age,&amp;income);
    if(income&lt;800)
      income+=90;
    fprintf(fpt,"%d %s %d %d\n",num,name,age,income);
  }
  fclose(fp);
  fclose(fpt);
  return 0;
}

int Creatfile(char *filename)
{
  FILE *fp;
  int num,age,income;
  char name[80];
  int count=0;

  fp=fopen(filename,"w+");
  while(scanf("%d %s %d %d",&amp;num,name,&amp;age,&amp;income),num)
  {
     fprintf(fp,"%d %s %d %d\n",num,name,age,income);
     count++;
  }
  fclose(fp);
  return count;
}

int main(int argc,char *argv[])
{
  int num;
  char temp[80];
  int count;

  if(argc&lt;2)
  {
     printf("please input the filename\n");
     return 1;
  }
  strcpy(temp,argv[1]);
  count=Creatfile(strcat(argv[1],".txt"));
  scanf("%d",&amp;num);
  search_work(argv[1],num);
  add(argv[1],strcat(temp,"modify.txt"),count);
  return 0;
}</code></pre>
</div>
